{{- $id := printf "codeblock-%02d" ( add .Ordinal 1) -}}
<figure>
  <div class="codeblock relative scroll-mt-8 not-prose" id="{{ $id }}">
    <aside
      class="absolute top-0 right-0 bg-black/10 dark:bg-white/10 transition-opacity px-2 rounded-bl-sm rounded-tr-sm hidden md:inline-block"
    >
      <div class="codeblock-meta flex flex-row space-x-3 items-center max-w-xs">
        <div class="font-mono text-sm small-caps shrink truncate cursor-default" aria-hidden="true">
          <span class="relative -top-[2px]">{{ .Type }}</span>
        </div>

        <div>
          <button
            type="button"
            aria-label="Copy code to clipboard"
            class="block hover:text-sky-400 dark:hover:text-blue-300 transition-colors copyToClipboard"
            data-id="{{ $id }}"
          >
            {{ partial "svg/clipboard.html" }}
          </button>
        </div>

        <div>
          <a
            href="#{{ $id }}"
            class="!text-neutral-700 hover:!text-sky-400 dark:!text-white/75 dark:hover:!text-blue-300 block"
            aria-label="Link to this code block"
          >
            {{ partial "svg/link.html" }}
          </a>
        </div>
      </div>
    </aside>

    <p class="sr-only">{{ .Type }} code snippet start</p>
    {{ transform.Highlight .Inner .Type .Options }}
    <p class="sr-only">{{ .Type }} code snippet end</p>
  </div>
  {{ with .Attributes.caption }}
    <figcaption class="text-center text-neutral-600 dark:text-white/70 italic">{{ . }}</figcaption>
  {{ end }}
</figure>
